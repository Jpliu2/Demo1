<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit" />
    <meta name="full-screen" content="yes" />
    <meta name="x5-fullscreen" content="true" />
    <meta name="keywords" content="我是关键字" />
    <meta itemprop="name" content="练习通知">
    <meta itemprop="description" content="练习已发布成功,请前往智学APP作答">
    <meta itemprop="image" content="http://mhwtest.zhixue.com/mhwpublic/sharehomeworkinfo/image/icon_image@2x.png">
    <meta name="description" content="练习已发布成功,请前往智学APP作答" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="format-detection" content="telephone=no,email=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no,minimal-ui"/>
    <title>练习通知</title>
    <link rel="icon" href="data:;base64,="/>
    <script src="js/base.js"></script>
    <script src="js/jquery.js"></script>
    <style>
        [v-cloak] {
            display: none;
        }
    </style>
    <link type="text/css" rel="styleSheet" href="./css/index.css" />
</head>
<body>
<!--网页中紧接着<body>加一个-->
<div style='margin:0 auto;width:0px;height:0px;overflow:hidden;'>
    <!--图片宽高大于400px，最好是一个正方形的图片-->
    <img src="http://mhwtest.zhixue.com/mhwpublic/sharehomeworkinfo/image/icon_image@2x.png" width='700'>
</div>
<div class="wrap" id="app" v-cloak>
    <img id="share_leftImage" src="./image/share_leftImg@2x.png" alt=""/>
    <img id="share_rightImage" src="./image/share_rightImg@2x.png" alt=""/>
    <img id="share_leftIcon" src="./image/share_leftIcon@2x.png" alt=""/>
    <img id="share_rightIcon" src="./image/share_rightIcon@2x.png" alt=""/>
    <!--作业内容-->
    <div id="backview">
        <div id="share_hworkInfo" v-if="isRequestSuccess">
            <div id="hworkInfo_hwTitle_div">
                <span id="hworkInfo_hwTitle">{{ hwTitle }}</span>
            </div>
            <div class="hworkInfo_hr_div"></div>
            <div id="hworkInfo_detail" v-if="!isRepeal">
                <!--作业信息-->
                <!--避免名称太长换行-->
                <div class="hworkInfo_topDetail">
                    <span class="hworkInfo_topDetail_left">练习名称:</span>
                    <span class="hworkInfo_topDetail_right" id="titleName">{{ hwTitle }}</span>
                </div>
                <div class="hworkInfo_topDetail">
                    <span class="hworkInfo_topDetail_left">练习类型:</span>
                    <span class="hworkInfo_topDetail_right">{{ hwTypeName }}</span>
                </div>
                <div class="hworkInfo_topDetail">
                    <span class="hworkInfo_topDetail_left">练习开始时间:</span>
                    <span class="hworkInfo_topDetail_right">{{ hwStartTime }}</span>
                </div>
                <div class="hworkInfo_topDetail">
                    <span class="hworkInfo_topDetail_left">练习结束时间:</span>
                    <span class="hworkInfo_topDetail_right">{{ hwEndTime }}</span>
                </div>
                <div id="hworkInfo_TipMsg_div">
                    <span id="hworkInfo_TipMsg">练习开始后同学们可在智学网APP上作答，请同学们按时完成练习哦~</span>
                </div>
            </div>
            <div id="hworkInfo_default" v-if="isRepeal">
                <img id="share_default_image" src="./image/share_default_image@2x.png" alt=""/>
                <br>
                <label class="share_default_label">练习已经被老师撤销了～</label>
            </div>
        </div>
        <!--缺省图片-->
        <div id="share_networkError" v-if="!isRequestSuccess">
            <img id="share_error_image" :src="tipImageSrc" alt=""/>
            <br>
            <label class="share_default_label">{{ tipText }}</label>
        </div>
        <div id="share_center_div">
            <img id="share_center_leftImage" src="./image/share_center_iconImg@2x.png" alt=""/>
            <img id="share_center_rightImage" src="./image/share_center_iconImg@2x.png" alt=""/>
        </div>
        <div id="share_step">
            <span id="step_span_title">找不到练习？看这里</span>
            <div class="step_div_tip">
                <span class="step_span_tip">第一步：打开智学网APP；</span>
            </div>
            <div class="step_div_tip">
                <span class="step_span_tip">第二步：使用学生智学网账号密码登录；</span>
            </div>
            <div class="step_div_tip">
                <span class="step_span_tip">第九步：在首页点击“练习中心”查看练习。</span>
            </div>
        </div>
        <!--空白容器-->
        <div id="share_tipBackview"></div>
        <div id="share_bottom">
            <span id="bottom_span">请在智学网APP内完成练习</span>
            <a><button id="bottom_btn">打开应用</button></a>
        </div>
    </div>
</div>
<!--蒙层-->
<div id="coverBackview" v-cloak>
    <img id="cover_tipImage" src="./image/cover_tipImage@2x.png" alt=""/>
    <span>
        请点击右上角 【...】
        <br>
        安卓：选择【在浏览器中打开】
        <br>
        iPhone：选择【在safari浏览器中打开】
    </span>
</div>
<script src="js/vue.js"></script>
<script src="js/index.js"></script>
<script type="text/javascript">
    $(function () {
        //打开应用
        $('a').click(function () {
            var u = navigator.userAgent, app = navigator.appVersion;
            var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Linux') > -1; //android终端或者uc浏览器
            var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
            if(u.toLowerCase().match(/MicroMessenger/i) == 'micromessenger'){
                alert("从微信浏览器打开");
                document.body.addEventListener('touchmove', function (e) {
                    e.preventDefault(); //阻止默认的处理方式(阻止下拉滑动的效果)
                }, {passive: false});
                $('#coverBackview').css('display','block');
            } else {
                if (isiOS){
                    //ios
                    var downLoadUrl = "https://itunes.apple.com/cn/app/智学网-让学习更简单/id981030648?mt=8";
                    var jumpUrl = "zhixue://www.zhixue.com?internalLink=JTdCJTIycHJvZHVjdFBhcmFtcyUyMiUzQSU3QiUyMm1vZHVsZSUyMiUzQSUyMmh3bGlzdF91bmZpbmlzaGVkJTIyJTdEJTJDJTIycHJvZHVjdFRhZyUyMiUzQSUyMnp5englMjIlN0Q=";
                    openIOSApp(downLoadUrl,jumpUrl);
                }

                if (isAndroid) {
                    //android
                    var jumpUrl = "zhixueapp://com.iflytek.elpmobile.smartlearning/open?destination=homeworkList";
                    var d = new Date();
                    var t0 = d.getTime();
                    var value = openApp(jumpUrl);
                    alert('5'+value);
                    if(openApp(jumpUrl)){
                        openApp(jumpUrl);
                    } else {
                        //由于打开需要1～2秒，利用这个时间差来处理－－打开app后，返回h5页面会出现页面变成app下载页面，影响用户体验
                        var delay = setInterval(function(){
                            var d = new Date();
                            var t1 = d.getTime();
                            if( t1-t0<3000 && t1-t0>2000){
                                $('a').attr('href', 'http://a.app.qq.com/o/simple.jsp?pkgname=com.iflytek.elpmobile.smartlearning');
                            }
                            if(t1-t0>=3000){
                                clearInterval(delay);
                            }
                        },1000);
                    }
                }
            }
        });

        function openIOSApp(downloadUrl,jumpUrl) {
            var hasApp = true;
            window.location.href = jumpUrl;
            window.onbeforeunload = function() {
                alert("Leave this page?");
                hasApp = false;
            }
            if (hasApp) {
                window.location.href = downloadUrl;
            }
        }

        function openApp(src) {
            // 通过iframe的方式试图打开APP，如果能正常打开，会直接切换到APP，并自动阻止a标签的默认行为
            // 否则打开a标签的href链接
            alert("true");
            var ifr = document.createElement('iframe');
            ifr.src = 'zhixueapp://';
            ifr.style.display = 'none';
            document.body.appendChild(ifr);
            window.setTimeout(function(){
                document.body.removeChild(ifr);
                alert("false");
                return false;
            },2000);
        }
    });
</script>
</body>
</html>
